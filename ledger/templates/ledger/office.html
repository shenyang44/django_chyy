{% extends 'ledger/layout.html' %}
{% block title %}Office Account{% endblock %}

{% block body %}
<header class="d-flex align-items-center flex-column">
    <span class="fs-3">Please Select Office Account to View.</span>
    <div class="btn-group my-3" role="group" aria-label="Basic radio toggle button group">
        {% for off_acc in off_accs %}
        <input type="radio" class="btn-check" name="btnradio" data-id='{{off_acc.id}}' id = "btnRadio{{off_acc.id}}" autocomplete="off">
        <label class="btn btn-outline-primary" for="btnRadio{{off_acc.id}}">{{off_acc.name}}</label>
        {% endfor %}
    </div>
</header>
{% for off_acc, trans_zipped in office_data %}
<table id='off-acc-{{off_acc.id}}' class="table d-none">
    <colgroup>
        <col style="width: 10%;">
        <col style="width:60%">
        <col style="width:10%">
        <col style="width: 10%;">
        <col style="width: 10%">
    </colgroup>
    <thead>
        <tr>
            <th scope="col" class="text-center">Date</th>
            <th scope="col">Item</th>
            <th class="text-center" scope="col">Debit</th>
            <th class="text-center" scope="col">Credit</th>
            <th scope="col">Balance</th>
        </tr>
    </thead>
    <tbody>
    {% for trans, entries in trans_zipped %}
        {% for desc, amt in entries %}
        <tr class="transRow">
            <td>{{trans.created_at|date:"j. n. Y"}}</td>
            <td>
                <div class="d-flex justify-content-between">
                    {% if trans.payee.name != off_acc.name %}
                        {{trans.payee.name}}
                    {% else %}
                        {{trans.receiver.name}}
                    {% endif %}
                    &nbsp;-&nbsp;
                    {{desc}}
                    <div class=" d-flex w-50 justify-content-end">
                        <div style="width: 40%; text-align: center;" >
                            {% if not trans.payee.is_external %}
                                <a href="{% url 'ledger:voucher' trans.id %}"><button type="button" class="btn btn-secondary">View voucher</button></a>
                            {% endif %}
                        </div>
                        
                        <div style="width: 40%; text-align: center;">
                            {% if not trans.receiver.is_external %}
                                <a href="{% url 'ledger:receipt' trans.id %}"><button type="button" class="btn btn-secondary">View receipt</button></a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </td>
            <td class="text-center">{% if trans.payee.file_no == off_acc.file_no %}{{amt}} {% endif %}</td>
            <td class="text-center">{% if trans.receiver.file_no == off_acc.file_no %}{{amt}}{% endif %}</td>
            <td>todo</td>
        </tr>
        {% endfor %}
    {% endfor %}
    </tbody>    
</table>
  
{% endfor %}


<script charset="utf-8">
    $(()=>{
        btnInputs = $('input');
        btnInputs.click((e)=>{
            id = $(e.target).attr('data-id')
            $('.table').not(`#off-acc-${id}`).addClass('d-none')
            $(`#off-acc-${id}`).removeClass('d-none')
        })
    })
</script>
{% endblock %}